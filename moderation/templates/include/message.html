{% load i18n %}
{% with wrapper.message as message %}
    <div class="media">
        <p class="pull-left {% if wrapper.needs_action %}text-danger{% else %}text-success{% endif %}">
        {% if wrapper.created_by_moderator %}
            <span class="glyphicon glyphicon-repeat conversation-icon" data-placement="left" data-toggle="tooltip" title="{% trans "This message was created by a moderator"%}"></span>
        {% else %}
            <span class="glyphicon glyphicon-envelope conversation-icon" data-placement="left" data-toggle="tooltip" title="{% trans "This message was received via SMS"%}"></span>
        {% endif %}
        </p>
        <div class="media-body">
            <h4 class="media-heading {% if wrapper.needs_action %}text-danger{% else %}text-success{% endif %}">{{ message.text }}</h4>
            <table class="table table-condensed">
                <tr>
                    <td>{% trans "Date Received" %}</td>
                    <td>{{ message.date }}</td>
                </tr>
                <tr>
                    <td>{% trans "Phone Number" %}</td>
                    <td>{{ message.connection.identity }}</td>
                </tr>
            </table>

            <!-- Message Effects -->
            <table class="table table-condensed">
                <thead>
                    <tr>
                        <th>{% trans "Stage" %}</th>
                        <th>{% trans "Priority" %}</th>
                        <th>{% trans "Operation" %}</th>
                        <th>{% trans "Name" %}</th>
                        <th>{% trans "Description" %}</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for effect_wrapper in wrapper.wrapped_effects %}
                        {% include "include/effect.html" %}
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endwith %}